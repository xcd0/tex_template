# tex_template

このファイル群は、通常texを分割した際に、
それぞれのtexでタイプセットできない問題を解決するために、
各章毎にフォルダ分けしてフォルダ毎に各章でタイプセットできるようにしたものです。
各texのプリアンブルそのままで、main.texとサブディレクトリの中のsub.texを編集します。

sub.texのあるディレクトリでmakeすれば、各章のsub.tex毎にでタイプセットできます。

main.texのあるディレクトリでmakeすれば、すべてまとめてタイプセットできます。


# サブディレクトリについて
サブディレクトリの構成
	任意のサブディレクトリ名
	├── Makefile -> ../Makefile
	├── img -> ../img
	├── src -> ../src
	├── sub.tex
	└── jlisting.sty

サブディレクトリの名前はmain.texの\include{}のパスを書き換えることで、
任意の名前を設定できます。

Makefile,img,srcはmain.texのシンボリックリンクで、実体はより上の階層に存在します。
これは画像ファイルなどについてmain.texとsub.texから見た相対パスを同じにするためです。
もし足りないパッケージがあればstyファイルをmain.texやsub.texのあるディレクトリに追加します。
例としてソースコードをそれなりに綺麗に表示するjlisting.styを置いています。

章を増やす際、サブディレクトリをコピーすると思います。
このとき普通に`cp -r 1 2`のようにするとシンボリックリンクが正しくコピーされません。
正しくコピーするためには`cp -Rfa 1 2`のようにしてコピーします。
もしシンボリックリンクが壊れてしまった場合以下のコマンドを実行します。
	cd (サブディレクトリのパス)
	ln -sf ../Makefile
	ln -sf ../img
	ln -sf ../src
	cd ..
	ln -sf ../Makefile

imgとsrcディレクトリの実態はmain.texと同じ階層にあるimgとsrcです。
Makefileの実体はmain.texのある階層の一つ上にしています。
これは複数のmain.texにおいてMakefileを使い回す事を想定して居るためです。
もちろんこれらのファイル構成は理解しているならば自由に変更できます。


## Makefileについて
MakefileはOS毎に依存しているコマンドが違います。
もちろんこれらは自由に置き換えることができます。
基本的にtexをタイプセットできて、PDFが閲覧できる環境なら問題ありません。
 - 全OS共通 : platex, dvipdfmx, extractbb
 - Windows : 未調査
 - Linux : texlive, evince
 - macOS : texlive

Makefileでやっていることは、
1.	OS毎にタイプセットに使うコマンドを設定 (platex, dvipdfmxなど)
2.	pngやjpgの画像ファイルについて.xbbファイルを生成 (extractbb)
3.	カレントディレクトリから拡張子が.texのファイルを取得
4.	.texのファイルをファイル毎にタイプセット、ゴミ掃除、PDF表示 (evinceなど)

です。


## プリアンブルについて
main.texやsub.texのプリアンブルには特殊な処理を書いています。
これは各章のsub.tex単体でタイプセットできるようにするためです。

タイプセットできる複数のtexを\include{}を使ってまとめてタイプセットするとエラーが発生してタイプセットできません。
これは\include{}を使うとインクルードされたファイルがそのまま貼り付けられるため、
1回しか書いてはならないプリアンブルや\begin{document}、\end{document}などがそのまま読み込まれてしまうためです。

プリアンブルの特殊な処理について簡単の説明します。
main.texで変数ifdraftを定義していて、sub.texでは定義していません。
sub.texではプその変数ifdraftが定義されていればsub.texプリアンブルが読み込まれません。

つまりsub.texをタイプセットするときは、sub.texのプリアンブルが読み込まれ通常通りタイプセットでき、
main.texをタイプセットすると変数ifdraftが定義されるためsub.texのプリアンブルが読み込まれず、
それ以外の本文だけが読み込まれることになり、すべてのtexを含んだ状態でタイプセットすることができます。



